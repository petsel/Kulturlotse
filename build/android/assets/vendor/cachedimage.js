module.exports=function(e){if(e.folder||(e.folder="Cache"),e.url&&e.view){if(Ti.Filesystem.isExternalStoragePresent())var a=Ti.Filesystem.externalStorageDirectory;else var a=Ti.Filesystem.applicationDataDirectory;var n=Ti.Filesystem.getFile(a,e.folder);n.exists()||(console.log("Info: directory created"),n.createDirectory());var r=Ti.Filesystem.getFile(a,e.folder,Ti.Utils.md5HexDigest(e.url)+".png");if(r.exists()&&e.view)return e.onload&&e.onload(),void("Ti.UI.ImageView"==e.view.apiName?e.view.setImage(r.read()):"Ti.UI.View"==e.view.apiName?e.view.setBackgroundImage(r.nativePath):"Ti.Proxy"==e.view.apiName&&(e.view.image=r.nativePath));var i=Ti.Network.createHTTPClient({timeout:1e5,ondatastream:function(a){e.onprogress&&"function"==typeof e.onprogress&&e.onprogress(a.progress)},onload:function(a){200==i.status?(r.write(this.responseData),console.log("Info: iamge cached"),e.onload&&e.onload(),e.view&&("Ti.UI.ImageView"==e.view.apiName?e.view.image=this.responseData:e.view.backgroundImage=r.getNativePath())):console.log("Warning: image caching unsuccessful "+a.status)},onerror:function(){console.log("Warning: image caching unsuccessful"+e.url),"Ti.UI.ImageView"==e.view.apiName}});console.log(e.url),i.open("GET",e.url,!0),i.send(null)}};