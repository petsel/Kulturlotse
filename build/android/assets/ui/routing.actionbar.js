"use strict";var ActionBar=require("com.alcoapps.actionbarextras"),modes=[{name:"walking",text:"Fußmarsch"},{name:"bicycling",text:"eigenes Fahrrad"},{name:"stadtrad",text:"StadtRad",stadtrad:!0},{name:"transit",text:"ÖPNV"},{name:"driving",text:"eigenes Kraftfahrzeug"}];module.exports=function(e){var a=JSON.parse(e.source.event);ActionBar.setTitle(a.title),ActionBar.setFont("PT Serif Bold"),ActionBar.subtitleColor="#444";var n=e.source.getActivity();n&&(n.onCreateOptionsMenu=function(a){a.menu.clear(),modes.forEach(function(n,r){a.menu.add({title:n.text,itemId:r,checkable:!0,checked:Ti.App.Properties.getString("MODE","walking")==n.name?!0:!1,showAsAction:Ti.Android.SHOW_AS_ACTION_NEVER}).addEventListener("click",function(){a.menu.getItems().forEach(function(e){e.setChecked(!1)}),a.menu.getItems()[r].setChecked(!0),Ti.App.Properties.setString("MODE",n.name),Ti.App.Properties.setString("MODESTRING",n.text),"stadtrad"==n.name?e.source.fireEvent("modechanged",{mode:"walking",stadtrad:n.stadtrad}):e.source.fireEvent("modechanged",{mode:n.name,stadtrad:n.stadtrad})})}),n.actionBar.displayHomeAsUp=!0,n.actionBar.onHomeIconItemSelected=function(){e.source.close()}})};